{"version":3,"sources":["../../../app/middleware/passport/notindex.js"],"names":["FacebookStrategy","require","Strategy","GithubStrategy","GoogleStrategy","LocalStrategy","auth","User","t","UserModel","module","exports","passport","serializeUser","user","done","deserializeUser","use","clientID","facebook","clientSecret","callbackURL","profileFields","token","refreshToken","profile","process","nextTick","_json","first_name","last_name","id","email","passportFindOrCreate","github","name","split","length","google","displayName","usernameField","passReqToCallback","req","password","passportCreateLocalUser","passportLogInCurrentUser"],"mappings":"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","file":"notindex.js","sourcesContent":["const FacebookStrategy  = require('passport-facebook').Strategy; // Allows for Facebook validation.\nconst GithubStrategy    = require('passport-github').Strategy; // Allowws for Github validation.\nconst GoogleStrategy    = require('passport-google-oauth2').Strategy;\nconst LocalStrategy     = require('passport-local').Strategy; // Allows for custom local validation.\nconst auth              = require('./../../config/auth.json'); // Super secret sauces.\nvar User                = require('./../../db/model/user'); // User model.\nconst t                 = require('./../../db/handler/user');\nconst UserModel         = new t();\n\n// Initialize with the passport instance to configure passport to run properly.\nmodule.exports = function(passport) {\n\n    // Used to serialize the user for the session.\n    passport.serializeUser(function(user, done) {\n        done(null, user); // This what will be logged into the session.\n    });\n\n    // Used to deserialize the user.\n    passport.deserializeUser(function(user, done) {\n        done(null, user); // This is what will be unlogged.\n    });\n\n    // =========================================================================\n    // FACEBOOK ================================================================\n    // =========================================================================\n    passport.use(new FacebookStrategy({ // Using the facebook passport startegy to lgo people in.\n        clientID        : auth.facebook.clientID, // Kittens.\n        clientSecret    : auth.facebook.clientSecret, // Secret sauce.\n        callbackURL     : 'http://127.0.0.1:3000/callback/facebook', // URls\n        profileFields   : ['id', 'emails', 'name'] // Permissions.\n    },\n      function(token, refreshToken, profile, done){ // Annoying thing that took me forever to figure out how to use.\n        process.nextTick(function(){ // Async function.\n          var user = {\n            \"fname\": profile._json.first_name,\n            \"lname\": profile._json.last_name,\n            \"provider\": \"facebook\",\n            \"id\": profile.id,\n            \"email\": profile._json.email\n          }\n          UserModel.passportFindOrCreate(user, done); // That one function.\n        }\n        );\n      }));\n    // =========================================================================\n    // GITHUB ==================================================================\n    // =========================================================================\n    passport.use(new GithubStrategy({\n      clientID        : auth.github.clientID, // Meerkat.\n      clientSecret    : auth.github.clientSecret, // Secret sauce.\n      callbackURL     : 'http://127.0.0.1:3000/callback/github',\n      profileFields   : ['id', 'emails', 'name'] // Permissions.\n      },\n      function(token, refreshToken, profile, done) { // Annoying thing that took me forever to figure out how to use.\n        process.nextTick(function(){ // Async function.\n          var user = {\n            \"fname\": profile._json.name.split(\" \")[0],\n            \"lname\": profile._json.name.split(\" \")[profile._json.name.split(\" \").length - 1],\n            \"provider\": \"github\",\n            \"id\": profile.id,\n            \"email\": profile._json.email\n          }\n          UserModel.passportFindOrCreate(user, done); // That one function.\n        });\n      }\n    ));\n    // =========================================================================\n    // Google REGISTRATION =====================================================\n    // =========================================================================\n    passport.use(new GoogleStrategy({\n      clientID      : auth.google.clientID,\n      clientSecret  : auth.google.clientSecret,\n      callbackURL   : 'http://127.0.0.1:3000/callback/google',\n      profileFields : ['id', 'emails', 'name']\n    },\n    function(token, refreshToken, profile, done) {\n      process.nextTick(function() {\n        var user = {\n          \"fname\": profile.displayName.split(\" \")[0],\n          \"lname\": profile.displayName.split(\" \")[profile.displayName.split(\" \").length - 1],\n          \"provider\": \"google\",\n          \"id\": profile.id,\n          \"email\": profile.email\n        };\n        UserModel.passportFindOrCreate(user, done);\n      });\n    }));\n    // =========================================================================\n    // LOCAL REGISTRATION ======================================================\n    // =========================================================================\n    passport.use('local-signup-dev', new LocalStrategy({\n      usernameField: 'email', // Changes the default from 'username' to 'email.'\n      passReqToCallback: true\n    },\n      function(req, email, password, done){\n        process.nextTick(function() { // Async.\n          UserModel.passportCreateLocalUser(req, email, password, 0, done); // That one function.\n        });\n      }\n    ));\n\n    passport.use('local-signup-nonprofit', new LocalStrategy({\n      usernameField: 'email', // Changes the default from 'username' to 'email.'\n      passReqToCallback: true\n    },\n      function(req, email, password, done){\n        process.nextTick(function() { // Async.\n          UserModel.passportCreateLocalUser(req, email, password, 1, done); // That one function.\n        });\n      }\n    ));\n    // =========================================================================\n    // LOCAL LOGIN =============================================================\n    // =========================================================================\n    passport.use('local-login', new LocalStrategy({\n      usernameField: 'email', // Need to specify that the field we want is email, not username.\n    },\n    function(email, password, done) {\n      process.nextTick(function() { // Async.\n        UserModel.passportLogInCurrentUser(email, password, done);\n      });\n    }));\n};\n"]}